<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel | Portfolio</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { background: #020617; color: #e5e7eb; font-family: 'Inter', sans-serif; }
  input, textarea { background: #1e293b; color: #e5e7eb; }
  input::placeholder, textarea::placeholder { color: #9ca3af; }
</style>
</head>
<body class="min-h-screen p-8">

<header class="mb-8">
  <h1 class="text-3xl font-bold text-cyan-400">Portfolio Admin Panel</h1>
  <p class="text-gray-400">Manage Hero, Skills, Projects, Experience, and Contact dynamically.</p>
</header>

<main class="grid grid-cols-1 md:grid-cols-2 gap-8">

  <!-- HERO -->
  <section class="bg-slate-800 p-6 rounded-2xl shadow-lg">
    <h2 class="text-xl font-semibold mb-4 text-cyan-400">Hero Section</h2>
    <form id="heroForm" class="flex flex-col gap-3">
      <input type="text" name="badge" placeholder="Badge" class="p-2 rounded" required>
      <input type="text" name="title" placeholder="Title" class="p-2 rounded" required>
      <textarea name="subtitle" placeholder="Subtitle" class="p-2 rounded" required></textarea>
      <input type="text" name="github_url" placeholder="GitHub URL" class="p-2 rounded">
      <button type="submit" class="bg-cyan-500 hover:bg-cyan-600 text-black p-2 rounded">Update Hero</button>
    </form>
    <div id="heroMessage" class="mt-2"></div>
  </section>

  <!-- SKILLS -->
  <section class="bg-slate-800 p-6 rounded-2xl shadow-lg">
    <h2 class="text-xl font-semibold mb-4 text-cyan-400">Skills</h2>
    <form id="skillForm" class="flex flex-col gap-3 mb-4">
      <input type="text" name="category" placeholder="Category" class="p-2 rounded" required>
      <textarea name="description" placeholder="Description" class="p-2 rounded" required></textarea>
      <button type="submit" class="bg-cyan-500 hover:bg-cyan-600 text-black p-2 rounded">Add Skill</button>
    </form>
    <div id="skillsList" class="flex flex-col gap-3"></div>
  </section>

  <!-- PROJECTS -->
  <section class="bg-slate-800 p-6 rounded-2xl shadow-lg">
    <h2 class="text-xl font-semibold mb-4 text-cyan-400">Projects</h2>
    <form id="projectForm" class="flex flex-col gap-3 mb-4">
      <input type="text" name="title" placeholder="Title" class="p-2 rounded" required>
      <textarea name="description" placeholder="Description" class="p-2 rounded" required></textarea>
      <input type="text" name="tech_stack" placeholder="Tech Stack" class="p-2 rounded" required>
      <input type="text" name="thumbnail_url" placeholder="Thumbnail URL" class="p-2 rounded">
      <input type="text" name="github_url" placeholder="GitHub URL" class="p-2 rounded">
      <input type="text" name="live_url" placeholder="Live URL" class="p-2 rounded">
      <button type="submit" class="bg-cyan-500 hover:bg-cyan-600 text-black p-2 rounded">Add Project</button>
    </form>
    <div id="projectsList" class="flex flex-col gap-3"></div>
  </section>

  <!-- EXPERIENCE -->
  <section class="bg-slate-800 p-6 rounded-2xl shadow-lg">
    <h2 class="text-xl font-semibold mb-4 text-cyan-400">Experience / Education</h2>
    <form id="experienceForm" class="flex flex-col gap-3 mb-4">
      <input type="text" name="title" placeholder="Title" class="p-2 rounded" required>
      <textarea name="description" placeholder="Description" class="p-2 rounded"></textarea>
      <button type="submit" class="bg-cyan-500 hover:bg-cyan-600 text-black p-2 rounded">Add Experience</button>
    </form>
    <div id="experienceList" class="flex flex-col gap-3"></div>
  </section>

  <!-- CONTACT -->
  <section class="bg-slate-800 p-6 rounded-2xl shadow-lg">
    <h2 class="text-xl font-semibold mb-4 text-cyan-400">Contact</h2>
    <form id="contactForm" class="flex flex-col gap-3 mb-4">
      <input type="email" name="email" placeholder="Email" class="p-2 rounded" required>
      <input type="text" name="github_url" placeholder="GitHub URL" class="p-2 rounded">
      <button type="submit" class="bg-cyan-500 hover:bg-cyan-600 text-black p-2 rounded">Update Contact</button>
    </form>
    <div id="contactMessage" class="mt-2"></div>
  </section>

</main>

<script>
const API_BASE = 'http://localhost:5000/api';

/* ===== HERO ===== */
async function loadHero() {
  const res = await fetch(`${API_BASE}/hero`);
  const hero = await res.json();
  const form = document.getElementById('heroForm');
  form.badge.value = hero.badge || '';
  form.title.value = hero.title || '';
  form.subtitle.value = hero.subtitle || '';
  form.github_url.value = hero.github_url || '';
}
document.getElementById('heroForm').addEventListener('submit', async e => {
  e.preventDefault();
  const form = e.target;
  const data = { badge: form.badge.value, title: form.title.value, subtitle: form.subtitle.value, github_url: form.github_url.value };
  const res = await fetch(`${API_BASE}/hero`, { method: 'PUT', headers: {'Content-Type':'application/json'}, body: JSON.stringify(data) });
  const result = await res.json();
  document.getElementById('heroMessage').textContent = result.message;
});
loadHero();

/* ===== SKILLS ===== */
async function loadSkills() {
  const res = await fetch(`${API_BASE}/skills`);
  const skills = await res.json();
  const container = document.getElementById('skillsList');
  container.innerHTML = '';
  skills.forEach(s => {
    const div = document.createElement('div');
    div.className = 'bg-slate-700 p-3 rounded flex justify-between items-center';
    div.innerHTML = `<span>${s.category} - ${s.description}</span> <button data-id="${s.id}" class="deleteBtn bg-red-500 hover:bg-red-600 text-white p-1 rounded">Delete</button>`;
    container.appendChild(div);
  });

  document.querySelectorAll('.deleteBtn').forEach(btn => {
    btn.addEventListener('click', async () => {
      await fetch(`${API_BASE}/skills/${btn.dataset.id}`, { method: 'DELETE' });
      loadSkills();
    });
  });
}
document.getElementById('skillForm').addEventListener('submit', async e => {
  e.preventDefault();
  const form = e.target;
  const data = { category: form.category.value, description: form.description.value };
  await fetch(`${API_BASE}/skills`, { method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(data) });
  form.reset();
  loadSkills();
});
loadSkills();

/* ===== PROJECTS ===== */
async function loadProjects() {
  const res = await fetch(`${API_BASE}/projects`);
  const projects = await res.json();
  const container = document.getElementById('projectsList');
  container.innerHTML = '';
  projects.forEach(p => {
    const div = document.createElement('div');
    div.className = 'bg-slate-700 p-3 rounded flex justify-between items-center';
    div.innerHTML = `<span>${p.title}</span> <button data-id="${p.id}" class="deleteBtn bg-red-500 hover:bg-red-600 text-white p-1 rounded">Delete</button>`;
    container.appendChild(div);
  });

  document.querySelectorAll('.deleteBtn').forEach(btn => {
    btn.addEventListener('click', async () => {
      await fetch(`${API_BASE}/projects/${btn.dataset.id}`, { method: 'DELETE' });
      loadProjects();
    });
  });
}
document.getElementById('projectForm').addEventListener('submit', async e => {
  e.preventDefault();
  const form = e.target;
  const data = { 
    title: form.title.value,
    description: form.description.value,
    tech_stack: form.tech_stack.value,
    thumbnail_url: form.thumbnail_url.value,
    github_url: form.github_url.value,
    live_url: form.live_url.value
  };
  await fetch(`${API_BASE}/projects`, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(data) });
  form.reset();
  loadProjects();
});
loadProjects();

/* ===== EXPERIENCE ===== */
async function loadExperience() {
  const res = await fetch(`${API_BASE}/experience`);
  const experiences = await res.json();
  const container = document.getElementById('experienceList');
  container.innerHTML = '';
  experiences.forEach(exp => {
    const div = document.createElement('div');
    div.className = 'bg-slate-700 p-3 rounded flex justify-between items-center';
    div.innerHTML = `<span>${exp.title}</span> <button data-id="${exp.id}" class="deleteBtn bg-red-500 hover:bg-red-600 text-white p-1 rounded">Delete</button>`;
    container.appendChild(div);
  });

  document.querySelectorAll('.deleteBtn').forEach(btn => {
    btn.addEventListener('click', async () => {
      await fetch(`${API_BASE}/experience/${btn.dataset.id}`, { method: 'DELETE' });
      loadExperience();
    });
  });
}
document.getElementById('experienceForm').addEventListener('submit', async e => {
  e.preventDefault();
  const form = e.target;
  const data = { title: form.title.value, description: form.description.value };
  await fetch(`${API_BASE}/experience`, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(data) });
  form.reset();
  loadExperience();
});
loadExperience();

/* ===== CONTACT ===== */
async function loadContact() {
  const res = await fetch(`${API_BASE}/contact`);
  const contact = await res.json();
  const form = document.getElementById('contactForm');
  form.email.value = contact.email || '';
  form.github_url.value = contact.github_url || '';
}
document.getElementById('contactForm').addEventListener('submit', async e => {
  e.preventDefault();
  const form = e.target;
  const data = { email: form.email.value, github_url: form.github_url.value };
  const res = await fetch(`${API_BASE}/contact`, { method:'PUT', headers:{'Content-Type':'application/json'}, body: JSON.stringify(data) });
  const result = await res.json();
  document.getElementById('contactMessage').textContent = result.message;
});
loadContact();
</script>

</body>
</html>
